(()=>{function e(t){document.querySelector("#booqs-dict-search-keyword").textContent=t;let o="https://www.booqs.net/api/v1/extension/search?keyword="+encodeURIComponent(t);fetch(o,{method:"GET"}).then((e=>e.json())).then((t=>{!function(t){console.log(t.data);let o=document.querySelector("#search-booqs-dict-results");if(o.innerHTML="",null!=t.data)t.data.forEach((function(t,n,a){console.log(t,n);let i='<div class="booqs-dict-entry">'+t.entry+'</div><div class="booqs-dict-meaning">'+t.meaning+'</div><div class="booqs-dict-explanation">'+function(e){let t=e.replace(/\r?\n/g,"<br>").split(/(\[{2}.*?\]{2})/),o=[];return t.forEach((function(e,t,n){if(null==e.match(/\[{2}.+\]{2}/))o.push(e);else{let t;t=null==(e=(e=e.replace(/\[{2}/g,"").replace(/\]{2}/g,"")).split(/\|/,2))[1]?`<a class="booqs-notation-link" data-value="${e[0]}">${e[0]}</a>`:`<a class="booqs-notation-link" data-value="${e[1]}">${e[0]}</a>`,o.push(t)}})),o.join("")}(t.explanation)+"</div>"+`<a href="https://www.booqs.net/ja/words/${t.id}" target="_blank" rel="noopener"><div class="booqs-dict-review-btn">復習する</div></a>`;o.insertAdjacentHTML("afterbegin",i),function(t){let o=t.querySelectorAll(".booqs-notation-link"),n=document.querySelector("#booqs-dict-search-form");o.forEach((function(t){t.addEventListener("click",(function(t){console.log(t);let o=t.target.dataset.value;return n.value!=o&&(n.value=o,e(o)),!1}))}))}(o)}));else{const e='<div class="booqs-dict-meaning">項目が見つかりませんでした。</div>';o.insertAdjacentHTML("afterbegin",e)}}(t)})).catch((e=>{console.log(e)}))}chrome.extension.onMessage.addListener((function(t,o,n){"Action"==t&&function(){let t=document.getElementById("booqs-dict-extension-wrapper");if(null==t){jsFrame=new JSFrame({horizontalAlign:"right"});const t='<div id="booqs-dict-extension-wrapper"><form method="get" action=""><input type="text" name="keyword" id="booqs-dict-search-form"></form><div id="booqs-dict-search-status">"<span id="booqs-dict-search-keyword"></span>"<span id="booqs-dict-search-status-text">の検索結果</span></div><div id="search-booqs-dict-results"></div></div>';let n=jsFrame.create({name:"booqs-dict-window",title:"BooQs Dictionary",width:320,height:480,movable:!0,resizable:!0,appearanceName:"material",appearanceParam:{border:{shadow:"2px 2px 10px  rgba(0, 0, 0, 0.5)",width:0,radius:6},titleBar:{name:"booqs-dict-window-bar",color:"white",background:"#273132",leftMargin:16,height:30,fontSize:14,buttonWidth:36,buttonHeight:16,buttonColor:"white",buttons:[{fa:"fas fa-times",name:"closeButton",visible:!0}]}},style:{overflow:"auto"},html:t});console.log(n),n.setPosition(-20,100,["RIGHT_TOP"]),n.show(),n.requestFocus();let a=document.querySelector("#booqs-dict-search-form");o=a,document.addEventListener("mouseup",(function(t){const n=window.getSelection().toString(),a=document.querySelector("#booqs-dict-search-keyword").textContent;""!=n&&a!=n&&(o.value=n,e(n),t.stopPropagation())}),!1),function(t){t.addEventListener("keyup",(function(){let o=t.value,n=document.querySelector("#booqs-dict-search-keyword").textContent;setTimeout((()=>{let t=document.querySelector("#booqs-dict-search-form").value;o==t&&o!=n&&e(o)}),500)}))}(a),function(e){e.addEventListener("keydown",(function(e){"Enter"==e.key&&e.preventDefault()}))}(a)}else t.parentNode.parentNode.parentNode.parentNode.parentNode.remove();var o}()}))})();