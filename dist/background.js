(()=>{const e="http://localhost:3000",t="Basic "+btoa(unescape(encodeURIComponent("4fc8087015e6bd355e48d5fee254822e6baa679e:2e187d8f2e6d5a324458e75b8e1c376f603a1b7d")));chrome.action.onClicked.addListener((function(e){chrome.tabs.sendMessage(e.id,"Action").then((e=>{})).catch((e=>{}))})),chrome.tabs.onUpdated.addListener((function(e){chrome.tabs.sendMessage(e,"Updated").then((e=>{})).catch((e=>{}))})),chrome.runtime.onMessage.addListener((function(e){switch(e.action){case"openOptionsPage":chrome.runtime.openOptionsPage()}})),chrome.runtime.onConnect.addListener((function(o){o.onMessage.addListener((function(n){switch(n.action){case"inspectCurrentUser":!async function(o){const n=await new Promise((o=>{fetch(`${e}/ja/api/v1/extensions/users/current`,{method:"GET",mode:"cors",credentials:"include",dataType:"json",headers:{"Content-Type":"application/json;charset=utf-8",authorization:t}}).then((e=>e.json())).then((e=>{e.user?function(e){chrome.storage.local.set({diqtUserName:e.name}),chrome.storage.local.set({diqtUserIconUrl:e.icon_url}),chrome.storage.local.set({diqtUserPublicUid:e.public_uid}),chrome.storage.local.set({diqtPopupDisplayed:e.popup_displayed}),chrome.storage.local.set({diqtDictionaries:e.dictionaries})}(e.user):(chrome.storage.local.set({diqtUserName:""}),chrome.storage.local.set({diqtUserIconUrl:""}),chrome.storage.local.set({diqtUserPublicUid:""}),chrome.storage.local.set({diqtPopupDisplayed:""})),o(e)})).catch((e=>{console.log(e),o("error")}))}));o.postMessage({data:n})}(o);break;case"search":!async function(o,n){chrome.storage.local.get(["diqtSelectedDictionaryId"],(async function(a){let s=a.diqtSelectedDictionaryId;""!=s&&null!=s||(s=1,chrome.storage.local.set({diqtSelectedDictionaryId:`${s}`}));const c=await function(o,n){return new Promise((a=>{const s=`${e}/api/v1/extensions/dictionaries/${n}/search`,c={method:"POST",mode:"cors",credentials:"include",body:JSON.stringify({keyword:o}),dataType:"json",headers:{"Content-Type":"application/json;charset=utf-8",authorization:t}};fetch(s,c).then((e=>e.json())).then((e=>{a(e)})).catch((e=>{a(e)}))}))}(n,s);o.postMessage({data:c})}))}(o,n.keyword);break;case"createReview":!async function(o,n){const a=await function(o){return new Promise((n=>{const a=`${e}/ja/api/v1/extensions/reviews`,s={method:"POST",mode:"cors",credentials:"include",body:JSON.stringify({quiz_id:o}),dataType:"json",headers:{"Content-Type":"application/json;charset=utf-8",authorization:t}};fetch(a,s).then((e=>e.json())).then((e=>{n(e)})).catch((e=>{console.log(e),n(e)}))}))}(n);o.postMessage({data:a})}(o,n.quizId);break;case"updateReview":!async function(o,n,a){const s=await function(o,n){return new Promise((a=>{const s=`${e}/ja/api/v1/extensions/reviews/${o}`,c={method:"PATCH",mode:"cors",credentials:"include",body:JSON.stringify({interval_setting:n}),dataType:"json",headers:{"Content-Type":"application/json;charset=utf-8",authorization:t}};fetch(s,c).then((e=>e.json())).then((e=>{a(e)})).catch((e=>{console.log(e),a(e)}))}))}(n,a);o.postMessage({data:s})}(o,n.reviewId,n.settingNumber);break;case"destroyReview":!async function(o,n){const a=await function(o){return new Promise((n=>{fetch(`${e}/ja/api/v1/extensions/reviews/${o}`,{method:"DELETE",mode:"cors",credentials:"include",dataType:"json",headers:{"Content-Type":"application/json;charset=utf-8",authorization:t}}).then((e=>e.json())).then((e=>{n(e)})).catch((e=>{console.log(e),n(e)}))}))}(n);o.postMessage({data:a})}(o,n.reviewId);break;case"googleTranslation":!async function(o,n){const a=await function(o){return new Promise((n=>{const a=`${e}/ja/api/v1/extensions/words/google_translate`,s={method:"POST",mode:"cors",credentials:"include",body:JSON.stringify({keyword:o}),dataType:"json",headers:{"Content-Type":"application/json;charset=utf-8",authorization:t}};fetch(a,s).then((e=>e.json())).then((e=>{n(e)})).catch((e=>{console.log(e),n(e)}))}))}(n);o.postMessage({data:a})}(o,n.keyword);break;case"deeplTranslation":!async function(o,n){const a=await function(o){return new Promise((n=>{const a=`${e}/ja/api/v1/extensions/words/deepl_translate`,s={method:"POST",mode:"cors",credentials:"include",body:JSON.stringify({keyword:o}),dataType:"json",headers:{"Content-Type":"application/json;charset=utf-8",authorization:t}};fetch(a,s).then((e=>e.json())).then((e=>{n(e)})).catch((e=>{console.log(e),n(e)}))}))}(n);o.postMessage({data:a})}(o,n.keyword)}}))}))})();