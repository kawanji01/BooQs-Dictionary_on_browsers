chrome.action.onClicked.addListener((function(e){chrome.tabs.sendMessage(e.id,"Action")})),chrome.runtime.onMessage.addListener((function(e){switch(console.log("message"),e.action){case"openOptionsPage":chrome.runtime.openOptionsPage()}})),chrome.runtime.onConnect.addListener((function(e){e.onMessage.addListener((function(o){switch(o.action){case"inspectCurrentUser":!async function(e){const o=await new Promise((e=>{fetch("https://www.booqs.net/ja/api/v1/extension/inspect_current_user",{method:"POST",mode:"cors",credentials:"include",dataType:"json",headers:{"Content-Type":"application/json;charset=utf-8"}}).then((e=>e.json())).then((o=>{o.data?function(e){chrome.storage.local.set({booqsDictUserName:e.name}),chrome.storage.local.set({booqsDictIconUrl:e.icon_url}),chrome.storage.local.set({booqsDictPublicUid:e.public_uid}),chrome.storage.local.set({booqsDictToken:e.token})}(o.data):(chrome.storage.local.set({booqsDictUserName:""}),chrome.storage.local.set({booqsDictIconUrl:""}),chrome.storage.local.set({booqsDictPublicUid:""}),chrome.storage.local.set({booqsDictToken:""})),console.log(o),e(o.data)})).catch((o=>{e("error")}))}));e.postMessage({data:o})}(e);break;case"isLoggedIn":isLoggedIn(e);break;case"renderReviewForm":!async function(e,o){const t=await function(e){return new Promise((o=>{chrome.storage.local.get(["booqsDictToken"],(function(t){if(!t.booqsDictToken)return o("unauthorized");let n="https://www.booqs.net/ja/api/v1/extension/review_setting";console.log(n);let s={method:"POST",mode:"cors",credentials:"include",body:JSON.stringify({word_id:e}),dataType:"json",headers:{"Content-Type":"application/json;charset=utf-8"}};console.log(n),fetch(n,s).then((e=>e.json())).then((e=>{console.log("success"),console.log(e),o(e.data)})).catch((e=>{console.log("error"),console.log(e),o(e)}))}))}))}(o);e.postMessage({data:t})}(e,o.wordId);break;case"createReminder":!async function(e,o,t){const n=await function(e,o){return new Promise((t=>{chrome.storage.local.get(["booqsDictToken"],(function(n){if(console.log(o),!n.booqsDictToken)return t("unauthorized");let s="https://www.booqs.net/ja/api/v1/extension/create_reminder";console.log(s);let a={method:"POST",mode:"cors",credentials:"include",body:JSON.stringify({quiz_id:e,setting_number:o}),dataType:"json",headers:{"Content-Type":"application/json;charset=utf-8"}};fetch(s,a).then((e=>e.json())).then((e=>{t(e)})).catch((e=>{console.log("create-error："+e),t(e)}))}))}))}(o,t);e.postMessage({data:n.data})}(e,o.quizId,o.settingNumber);break;case"updateReminder":!async function(e,o,t){const n=await function(e,o){return new Promise((t=>{chrome.storage.local.get(["booqsDictToken"],(function(n){if(!n.booqsDictToken)return t("unauthorized");let s={method:"POST",mode:"cors",credentials:"include",body:JSON.stringify({quiz_id:e,setting_number:o}),dataType:"json",headers:{"Content-Type":"application/json;charset=utf-8"}};fetch("https://www.booqs.net/ja/api/v1/extension/update_reminder",s).then((e=>e.json())).then((e=>{t(e)})).catch((e=>{console.log("update-error："+e),t(e)}))}))}))}(o,t);e.postMessage({data:n.data})}(e,o.quizId,o.settingNumber);break;case"destroyReminder":!async function(e,o){const t=await function(e){return new Promise((o=>{chrome.storage.local.get(["booqsDictToken"],(function(t){if(!t.booqsDictToken)return o("unauthorized");let n={method:"POST",mode:"cors",credentials:"include",body:JSON.stringify({quiz_id:e}),dataType:"json",headers:{"Content-Type":"application/json;charset=utf-8"}};fetch("https://www.booqs.net/ja/api/v1/extension/destroy_reminder",n).then((e=>e.json())).then((e=>{console.log(e),o(e)})).catch((e=>{console.log("destroy-error："+e),o(e)}))}))}))}(o);e.postMessage({data:t.data})}(e,o.quizId);break;case"googleTranslation":!async function(e,o){const t=await function(e){return new Promise((o=>{let t={method:"POST",mode:"cors",credentials:"include",body:JSON.stringify({keyword:e}),dataType:"json",headers:{"Content-Type":"application/json;charset=utf-8"}};fetch("https://www.booqs.net/ja/api/v1/extension/google_translate",t).then((e=>e.json())).then((e=>{console.log(e),o(e)})).catch((e=>{console.log(e),o(e)}))}))}(o);e.postMessage({data:t})}(e,o.keyword);break;case"deeplTranslation":!async function(e,o){const t=await function(e){return new Promise((o=>{let t={method:"POST",mode:"cors",credentials:"include",body:JSON.stringify({keyword:e}),dataType:"json",headers:{"Content-Type":"application/json;charset=utf-8"}};fetch("https://www.booqs.net/ja/api/v1/extension/deepl_translate",t).then((e=>e.json())).then((e=>{console.log(e),o(e)})).catch((e=>{console.log(e),o(e)}))}))}(o);e.postMessage({data:t})}(e,o.keyword)}}))}));